import{d as P,f as w,u as L,g as M,h as D,b as F,c as E,i as a,j as d,w as h,_ as S,k as p,l as A,m as V,n as I,r as G,T as N,p as W,q as H,s as Y}from"./index-48af4c27.js";import{r as $,e as T,c as R,m as j,u as B,_ as b,s as q}from"./index.esm-cb25b060.js";import"./browser-ponyfill-10e9505f.js";const O="/vue-ts-composition-ecommerce/google-auth-icon.svg",z="/vue-ts-composition-ecommerce/github-auth-icon.svg",J=["onSubmit"],K=a("h2",{class:"text-center text-[22px] font-bold"},"Sign in",-1),Q={class:"flex flex-col gap-2"},X=a("div",{class:"flex items-center justify-center gap-5"},[a("img",{class:"h-[24px] w-[24px]",src:O,alt:"Google"}),a("span",null,"Sign in with Google")],-1),Z=a("div",{class:"flex items-center justify-center gap-5"},[a("img",{class:"h-[24px] w-[24px]",src:z,alt:"Github"}),a("span",null,"Sign in with Github")],-1),ee=a("div",{class:"border-b"},null,-1),se=P({__name:"LoginForm",emits:["display-sign-up-form","display-restore-password-form","hide-modal"],setup(U,{emit:l}){const e=w(""),s=w(""),m=()=>l("display-sign-up-form"),o=()=>l("display-restore-password-form"),{isLoading:c,error:t,signIn:g,signInWithOAuth:x}=L(),v=M(),f=async()=>{await r.value.$validate()&&(await g({email:e.value,password:s.value}),t.value?v.error(t.value||"Unknown error"):(v.success("Authentication completed"),l("hide-modal")))},i=async _=>{await x(_)},u=D(()=>({login:{required:$,email:T},password:{required:$,password_validation:R.withMessage("Minimum 6 symbols length",j(6))}})),r=B(u,{login:e,password:s},{$autoDirty:!0});return(_,n)=>{var k,y;return F(),E("form",{onClick:n[4]||(n[4]=V(()=>{},["stop"])),onSubmit:V(f,["prevent"]),class:"mx-3 flex w-full flex-col gap-5 rounded-xl bg-white p-5 md:mx-0 md:max-w-sm"},[K,a("div",Q,[d(S,{type:"button",variant:"transparent",onClick:n[0]||(n[0]=C=>i("google"))},{default:h(()=>[X]),_:1}),d(S,{type:"button",variant:"transparent",onClick:n[1]||(n[1]=C=>i("github"))},{default:h(()=>[Z]),_:1})]),ee,d(b,{modelValue:e.value,"onUpdate:modelValue":n[2]||(n[2]=C=>e.value=C),label:"Email address",error:(k=p(r).login.$errors[0])==null?void 0:k.$message},null,8,["modelValue","error"]),d(b,{modelValue:s.value,"onUpdate:modelValue":n[3]||(n[3]=C=>s.value=C),type:"password",label:"Your Password",error:(y=p(r).password.$errors[0])==null?void 0:y.$message},null,8,["modelValue","error"]),d(S,{type:"submit",variant:"primary",loading:p(c)},{default:h(()=>[A("Sign in")]),_:1},8,["loading"]),a("p",{role:"button",class:"text-center text-sm text-base-gray underline",onClick:o}," Forgot your password? "),a("p",{role:"button",class:"text-center text-sm text-base-gray underline",onClick:m}," Don't have an account? Sign up ")],40,J)}}}),oe=["onSubmit"],te=a("h2",{class:"text-center text-[22px] font-bold"},"Sign up",-1),ae=P({__name:"SignupForm",emits:["display-sign-in-form","hide-modal"],setup(U,{emit:l}){const e=w(""),s=w(""),m=w(""),o=()=>l("display-sign-in-form"),{isLoading:c,error:t,signUp:g}=L(),x=M(),v=async()=>{await i.value.$validate()&&(await g({email:e.value,password:s.value}),t.value?x.error(t.value||"Unknown error"):(x.success(`User ${e.value} registered`),l("hide-modal")))},f=D(()=>({login:{required:$,email:T},confirmedPassword:{required:$,confirmed_password_validation:R.withMessage("Passwords do not match",q(s))},password:{required:$,password_validation:R.withMessage("Minimum 6 symbols length",j(6))}})),i=B(f,{login:e,password:s,confirmedPassword:m},{$autoDirty:!0});return(u,r)=>{var _,n,k;return F(),E("form",{onClick:r[3]||(r[3]=V(()=>{},["stop"])),onSubmit:V(v,["prevent"]),class:"mx-3 flex w-full flex-col gap-5 rounded-xl bg-white p-5 md:mx-0 md:max-w-sm"},[te,d(b,{modelValue:e.value,"onUpdate:modelValue":r[0]||(r[0]=y=>e.value=y),label:"Email address",error:(_=p(i).login.$errors[0])==null?void 0:_.$message},null,8,["modelValue","error"]),d(b,{type:"password",modelValue:s.value,"onUpdate:modelValue":r[1]||(r[1]=y=>s.value=y),label:"Your Password",error:(n=p(i).password.$errors[0])==null?void 0:n.$message},null,8,["modelValue","error"]),d(b,{modelValue:m.value,"onUpdate:modelValue":r[2]||(r[2]=y=>m.value=y),type:"password",label:"Confirm Password",error:(k=p(i).confirmedPassword.$errors[0])==null?void 0:k.$message},null,8,["modelValue","error"]),d(S,{type:"submit",variant:"primary",loading:p(c)},{default:h(()=>[A("Sign up")]),_:1},8,["loading"]),a("p",{role:"button",class:"text-center text-sm text-base-gray underline",onClick:o}," Sign in ")],40,oe)}}}),re=P({__name:"BaseAdjustableHeightWrapper",setup(U){const l=w("0"),e=o=>{const{height:c}=getComputedStyle(o);o.style.height=l.value,setTimeout(()=>{o.style.height=c})},s=o=>o.style.height="auto",m=o=>l.value=getComputedStyle(o).height;return(o,c)=>(F(),I(N,{name:"height",mode:"out-in",onBeforeLeave:m,onEnter:e,onAfterEnter:s},{default:h(()=>[G(o.$slots,"default")]),_:3}))}}),ne=["onSubmit"],le={class:"flex w-full flex-col gap-5"},ie=a("h2",{class:"text-center text-[22px] font-bold"},"Restore password",-1),de=P({__name:"RestorePasswordForm",emits:["display-sign-up-form"],setup(U,{emit:l}){const e=w(""),s=()=>l("display-sign-up-form"),{isLoading:m,error:o,sendPasswordResetLink:c}=L(),t=M(),g=async()=>{await v.value.$validate()&&(await c(e.value),o.value?t.error(o.value||"Unknown error"):t.success(`Confirmation link successfully sent to ${e.value}`))},x=D(()=>({login:{required:$,email:T}})),v=B(x,{login:e},{$autoDirty:!0});return(f,i)=>{var u;return F(),E("form",{onClick:i[1]||(i[1]=V(()=>{},["stop"])),onSubmit:V(g,["prevent"]),class:"mx-3 w-full rounded-xl bg-white p-5 md:mx-0 md:max-w-sm"},[a("section",le,[ie,d(b,{modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=r=>e.value=r),label:"Email address",error:(u=p(v).login.$errors[0])==null?void 0:u.$message},null,8,["modelValue","error"]),d(S,{type:"submit",variant:"primary",loading:p(m)},{default:h(()=>[A("Restore password")]),_:1},8,["loading"]),a("p",{role:"button",class:"text-center text-sm text-base-gray underline",onClick:s}," Sign up ")])],40,ne)}}}),ue=["onSubmit"],me={class:"flex w-full flex-col gap-5"},pe=a("h2",{class:"text-center text-[22px] font-bold"},"Update password",-1),ce=P({__name:"UpdatePasswordForm",emits:["hide-modal"],setup(U,{emit:l}){const e=w(""),s=w(""),{isLoading:m,error:o,updatePassword:c}=L(),t=M(),g=W(),x=async()=>{await f.value.$validate()&&(await c(e.value),o.value?t.error(o.value||"Unknown error"):(t.success("Password changed"),await g.replace({query:{}}),setTimeout(()=>l("hide-modal"),5e3)))},v=D(()=>({confirmedPassword:{required:$,confirmed_password_validation:R.withMessage("Passwords do not match",q(e))},password:{required:$,password_validation:R.withMessage("Minimum 6 symbols length",j(6))}})),f=B(v,{password:e,confirmedPassword:s},{$autoDirty:!0});return(i,u)=>{var r,_;return F(),E("form",{onClick:u[2]||(u[2]=V(()=>{},["stop"])),onSubmit:V(x,["prevent"]),class:"mx-3 w-full rounded-xl bg-white p-5 md:mx-0 md:max-w-sm"},[a("section",me,[pe,d(b,{type:"password",modelValue:e.value,"onUpdate:modelValue":u[0]||(u[0]=n=>e.value=n),label:"New Password",error:(r=p(f).password.$errors[0])==null?void 0:r.$message},null,8,["modelValue","error"]),d(b,{modelValue:s.value,"onUpdate:modelValue":u[1]||(u[1]=n=>s.value=n),type:"password",label:"Confirm Password",error:(_=p(f).confirmedPassword.$errors[0])==null?void 0:_.$message},null,8,["modelValue","error"]),d(S,{type:"submit",variant:"primary",loading:p(m)},{default:h(()=>[A("Update password")]),_:1},8,["loading"])])],40,ue)}}}),fe=P({__name:"AuthFormWrapper",emits:["hide-modal"],setup(U,{emit:l}){const e={LoginForm:se,SignupForm:ae,RestorePasswordForm:de,UpdatePasswordForm:ce},s=w("LoginForm");H().query.update_password&&(s.value="UpdatePasswordForm");const o=()=>l("hide-modal");return(c,t)=>(F(),I(re,null,{default:h(()=>[(F(),I(Y(e[s.value]),{key:s.value,onDisplaySignUpForm:t[0]||(t[0]=g=>s.value="SignupForm"),onDisplaySignInForm:t[1]||(t[1]=g=>s.value="LoginForm"),onDisplayRestorePasswordForm:t[2]||(t[2]=g=>s.value="RestorePasswordForm"),onHideModal:o},null,32))]),_:1}))}});export{fe as default};
