import{d as U,f as w,u as L,g as M,h as D,b as S,c as G,i as a,j as d,w as b,k as u,_ as P,l as E,m as F,n as I,r as N,T as W,p as H,q as Y,s as O}from"./index-b7afee38.js";import{r as $,e as A,c as R,m as j,u as B,_ as V,s as q}from"./index.esm-93c71503.js";import"./browser-ponyfill-10e9505f.js";const z="/vue-ts-composition-ecommerce/google-auth-icon.svg",J="/vue-ts-composition-ecommerce/github-auth-icon.svg";var T=(v=>(v.Google="google",v.Github="github",v))(T||{});const K=["onSubmit"],Q=a("h2",{class:"text-center text-[22px] font-bold"},"Sign in",-1),X={class:"flex flex-col gap-2"},Z=a("div",{class:"flex items-center justify-center gap-5"},[a("img",{class:"h-[24px] w-[24px]",src:z,alt:"Google"}),a("span",null,"Sign in with Google")],-1),ee=a("div",{class:"flex items-center justify-center gap-5"},[a("img",{class:"h-[24px] w-[24px]",src:J,alt:"Github"}),a("span",null,"Sign in with Github")],-1),se=a("div",{class:"border-b"},null,-1),oe=U({__name:"LoginForm",emits:["display-sign-up-form","display-restore-password-form","hide-modal"],setup(v,{emit:l}){const e=w(""),s=w(""),p=()=>l("display-sign-up-form"),o=()=>l("display-restore-password-form"),{isLoading:c,error:t,signIn:g,signInWithOAuth:y}=L(),f=M(),_=async()=>{await r.value.$validate()&&(await g({email:e.value,password:s.value}),t.value?f.error(t.value||"Unknown error"):(f.success("Authentication completed"),l("hide-modal")))},i=async x=>{await y(x)},m=D(()=>({login:{required:$,email:A},password:{required:$,password_validation:R.withMessage("Minimum 6 symbols length",j(6))}})),r=B(m,{login:e,password:s},{$autoDirty:!0});return(x,n)=>{var k,h;return S(),G("form",{onClick:n[4]||(n[4]=F(()=>{},["stop"])),onSubmit:F(_,["prevent"]),class:"mx-3 flex w-full flex-col gap-5 rounded-xl bg-white p-5 md:mx-0 md:max-w-sm"},[Q,a("div",X,[d(P,{type:"button",variant:"transparent",onClick:n[0]||(n[0]=C=>i(u(T).Google))},{default:b(()=>[Z]),_:1}),d(P,{type:"button",variant:"transparent",onClick:n[1]||(n[1]=C=>i(u(T).Github))},{default:b(()=>[ee]),_:1})]),se,d(V,{modelValue:e.value,"onUpdate:modelValue":n[2]||(n[2]=C=>e.value=C),label:"Email address",error:(k=u(r).login.$errors[0])==null?void 0:k.$message},null,8,["modelValue","error"]),d(V,{modelValue:s.value,"onUpdate:modelValue":n[3]||(n[3]=C=>s.value=C),type:"password",label:"Your Password",error:(h=u(r).password.$errors[0])==null?void 0:h.$message},null,8,["modelValue","error"]),d(P,{type:"submit",variant:"primary",loading:u(c)},{default:b(()=>[E("Sign in")]),_:1},8,["loading"]),a("p",{role:"button",class:"text-center text-sm text-base-gray underline",onClick:o}," Forgot your password? "),a("p",{role:"button",class:"text-center text-sm text-base-gray underline",onClick:p}," Don't have an account? Sign up ")],40,K)}}}),te=["onSubmit"],ae=a("h2",{class:"text-center text-[22px] font-bold"},"Sign up",-1),re=U({__name:"SignupForm",emits:["display-sign-in-form","hide-modal"],setup(v,{emit:l}){const e=w(""),s=w(""),p=w(""),o=()=>l("display-sign-in-form"),{isLoading:c,error:t,signUp:g}=L(),y=M(),f=async()=>{await i.value.$validate()&&(await g({email:e.value,password:s.value}),t.value?y.error(t.value||"Unknown error"):(y.success(`User ${e.value} registered`),l("hide-modal")))},_=D(()=>({login:{required:$,email:A},confirmedPassword:{required:$,confirmed_password_validation:R.withMessage("Passwords do not match",q(s))},password:{required:$,password_validation:R.withMessage("Minimum 6 symbols length",j(6))}})),i=B(_,{login:e,password:s,confirmedPassword:p},{$autoDirty:!0});return(m,r)=>{var x,n,k;return S(),G("form",{onClick:r[3]||(r[3]=F(()=>{},["stop"])),onSubmit:F(f,["prevent"]),class:"mx-3 flex w-full flex-col gap-5 rounded-xl bg-white p-5 md:mx-0 md:max-w-sm"},[ae,d(V,{modelValue:e.value,"onUpdate:modelValue":r[0]||(r[0]=h=>e.value=h),label:"Email address",error:(x=u(i).login.$errors[0])==null?void 0:x.$message},null,8,["modelValue","error"]),d(V,{type:"password",modelValue:s.value,"onUpdate:modelValue":r[1]||(r[1]=h=>s.value=h),label:"Your Password",error:(n=u(i).password.$errors[0])==null?void 0:n.$message},null,8,["modelValue","error"]),d(V,{modelValue:p.value,"onUpdate:modelValue":r[2]||(r[2]=h=>p.value=h),type:"password",label:"Confirm Password",error:(k=u(i).confirmedPassword.$errors[0])==null?void 0:k.$message},null,8,["modelValue","error"]),d(P,{type:"submit",variant:"primary",loading:u(c)},{default:b(()=>[E("Sign up")]),_:1},8,["loading"]),a("p",{role:"button",class:"text-center text-sm text-base-gray underline",onClick:o}," Sign in ")],40,te)}}}),ne=U({__name:"BaseAdjustableHeightWrapper",setup(v){const l=w("0"),e=o=>{const{height:c}=getComputedStyle(o);o.style.height=l.value,setTimeout(()=>{o.style.height=c})},s=o=>o.style.height="auto",p=o=>l.value=getComputedStyle(o).height;return(o,c)=>(S(),I(W,{name:"height",mode:"out-in",onBeforeLeave:p,onEnter:e,onAfterEnter:s},{default:b(()=>[N(o.$slots,"default")]),_:3}))}}),le=["onSubmit"],ie={class:"flex w-full flex-col gap-5"},de=a("h2",{class:"text-center text-[22px] font-bold"},"Restore password",-1),ue=U({__name:"RestorePasswordForm",emits:["display-sign-up-form"],setup(v,{emit:l}){const e=w(""),s=()=>l("display-sign-up-form"),{isLoading:p,error:o,sendPasswordResetLink:c}=L(),t=M(),g=async()=>{await f.value.$validate()&&(await c(e.value),o.value?t.error(o.value||"Unknown error"):t.success(`Confirmation link successfully sent to ${e.value}`))},y=D(()=>({login:{required:$,email:A}})),f=B(y,{login:e},{$autoDirty:!0});return(_,i)=>{var m;return S(),G("form",{onClick:i[1]||(i[1]=F(()=>{},["stop"])),onSubmit:F(g,["prevent"]),class:"mx-3 w-full rounded-xl bg-white p-5 md:mx-0 md:max-w-sm"},[a("section",ie,[de,d(V,{modelValue:e.value,"onUpdate:modelValue":i[0]||(i[0]=r=>e.value=r),label:"Email address",error:(m=u(f).login.$errors[0])==null?void 0:m.$message},null,8,["modelValue","error"]),d(P,{type:"submit",variant:"primary",loading:u(p)},{default:b(()=>[E("Restore password")]),_:1},8,["loading"]),a("p",{role:"button",class:"text-center text-sm text-base-gray underline",onClick:s}," Sign up ")])],40,le)}}}),me=["onSubmit"],pe={class:"flex w-full flex-col gap-5"},ce=a("h2",{class:"text-center text-[22px] font-bold"},"Update password",-1),ge=U({__name:"UpdatePasswordForm",emits:["hide-modal"],setup(v,{emit:l}){const e=w(""),s=w(""),{isLoading:p,error:o,updatePassword:c}=L(),t=M(),g=H(),y=async()=>{await _.value.$validate()&&(await c(e.value),o.value?t.error(o.value||"Unknown error"):(t.success("Password changed"),await g.replace({query:{}}),setTimeout(()=>l("hide-modal"),5e3)))},f=D(()=>({confirmedPassword:{required:$,confirmed_password_validation:R.withMessage("Passwords do not match",q(e))},password:{required:$,password_validation:R.withMessage("Minimum 6 symbols length",j(6))}})),_=B(f,{password:e,confirmedPassword:s},{$autoDirty:!0});return(i,m)=>{var r,x;return S(),G("form",{onClick:m[2]||(m[2]=F(()=>{},["stop"])),onSubmit:F(y,["prevent"]),class:"mx-3 w-full rounded-xl bg-white p-5 md:mx-0 md:max-w-sm"},[a("section",pe,[ce,d(V,{type:"password",modelValue:e.value,"onUpdate:modelValue":m[0]||(m[0]=n=>e.value=n),label:"New Password",error:(r=u(_).password.$errors[0])==null?void 0:r.$message},null,8,["modelValue","error"]),d(V,{modelValue:s.value,"onUpdate:modelValue":m[1]||(m[1]=n=>s.value=n),type:"password",label:"Confirm Password",error:(x=u(_).confirmedPassword.$errors[0])==null?void 0:x.$message},null,8,["modelValue","error"]),d(P,{type:"submit",variant:"primary",loading:u(p)},{default:b(()=>[E("Update password")]),_:1},8,["loading"])])],40,me)}}}),_e=U({__name:"AuthFormWrapper",emits:["hide-modal"],setup(v,{emit:l}){const e={LoginForm:oe,SignupForm:re,RestorePasswordForm:ue,UpdatePasswordForm:ge},s=w("LoginForm");Y().query.update_password&&(s.value="UpdatePasswordForm");const o=()=>l("hide-modal");return(c,t)=>(S(),I(ne,null,{default:b(()=>[(S(),I(O(e[s.value]),{key:s.value,onDisplaySignUpForm:t[0]||(t[0]=g=>s.value="SignupForm"),onDisplaySignInForm:t[1]||(t[1]=g=>s.value="LoginForm"),onDisplayRestorePasswordForm:t[2]||(t[2]=g=>s.value="RestorePasswordForm"),onHideModal:o},null,32))]),_:1}))}});export{_e as default};
